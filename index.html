<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>سجل تقارير MDT</title>
 
  
  <link rel="stylesheet" href="styles.css"/>
  <style>

  <script src="script.js"></script>

    
    .report {
      border-bottom: 1px solid #444;
      padding: 15px 0;
    }
    .report img {
      max-width: 100px;
      border-radius: 5px;
      margin-top: 10px;
    }
    .search {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>سجل تقارير MDT</h1>

    <div class="search">
      <input type="text" id="searchInput" placeholder="ابحث باسم الشخص..." oninput="renderReports()" />
    </div>

    <div id="reportList"></div>
  </div>

  <script>
    function renderReports() {
 
      const reports = JSON.parse(localStorage.getItem("mdtReports") || "[]");
      const search = document.getElementById("searchInput").value.trim().toLowerCase();
      const list = document.getElementById("reportList");  

      const filtered = reports.filter(r => r.personName.toLowerCase().includes(search));

      function renderReports() {
    const reportsContainer = document.getElementById("reports-container");
    reportsContainer.innerHTML = "";
    const reports = JSON.parse(localStorage.getItem("mdtReports") || "[]");

    reports.forEach((report, index) => {
        const reportDiv = document.createElement("div");
        reportDiv.className = "report";
        reportDiv.innerHTML = `
            <img src="${report.image || 'https://via.placeholder.com/80'}" alt="صورة الشخص">
            <div class="info">
                <p><strong>الاسم:</strong> ${report.personName}</p>
                <p><strong>مقدم:</strong> ${report.reporterName}</p>
                <p><strong>حالة المهمة:</strong> ${report.missionStatus}</p>
                <p><strong>نوع الحالة:</strong> ${report.caseType}</p>
                <p><strong>الرمز الدولي:</strong> ${report.personCode}</p>
                <p><strong>معلومات إضافية:</strong> ${report.additionalInfo || "لا يوجد"}</p>
                <button class="delete-single" data-index="${index}">حذف هذا التقرير</button>
            </div>
        `;
        reportsContainer.appendChild(reportDiv);
    });
}

document.addEventListener("DOMContentLoaded", renderReports);

document.addEventListener("click", function (e) {
    if (e.target.classList.contains("delete-single")) {
        const index = e.target.getAttribute("data-index");
        const pass = prompt("أدخل الرمز السري لحذف التقرير:");
        if (pass === "3112.MDT") {
            const reports = JSON.parse(localStorage.getItem("mdtReports") || "[]");
            reports.splice(index, 1);
            localStorage.setItem("mdtReports", JSON.stringify(reports));
            renderReports();
        } else {
            alert("رمز خاطئ، لم يتم الحذف.");
        }
    }
});
      `).join('') || "<p>لا توجد تقارير تطابق البحث.</p>";
    }

    




    document.addEventListener("DOMContentLoaded", renderReports);
  </script>
</body>
</html>
